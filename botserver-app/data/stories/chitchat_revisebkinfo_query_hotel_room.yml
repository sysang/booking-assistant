version: "3.1"

stories:
- story: when information is being collected, bkinfo_bed_type, revise area
  steps:
  - slot_was_set:
    - botmind_state: attentive
    - botmind_context: workingonbooking
    - botmemo_booking_progress: information_collecting
    - bkinfo_area: true
    - bkinfo_checkin_time: true
    - bkinfo_duration: true
    - bkinfo_bed_type: null
    - bkinfo_price: null
    - bkinfo_room_id: null
    - search_result_flag: waiting
  - action: bkinfo_form
  - active_loop: bkinfo_form
  - slot_was_set:
    - requested_slot: bkinfo_bed_type
  - intent: revise_area
    entities:
      - area: hawaii
  - slot_was_set:
      - bkinfo_area: hawaii
  - action: action_execution_rejected
  - action: action_deactivate_loop
  - active_loop: null
  - action: botacts_utter_revised_bkinfo
  - action: bkinfo_form
  - active_loop: bkinfo_form
  - slot_was_set:
      - requested_slot: bkinfo_bed_type

- story: when information has being collected, bkinfo_duration, revise check-in time
  steps:
  - slot_was_set:
    - botmind_state: attentive
    - botmind_context: workingonbooking
    - botmemo_booking_progress: information_collecting
    - bkinfo_area: true
    - bkinfo_checkin_time: true
    - bkinfo_duration: null
    - bkinfo_bed_type: null
    - bkinfo_price: null
    - bkinfo_room_id: null
    - search_result_flag: waiting
  - action: bkinfo_form
  - active_loop: bkinfo_form
  - slot_was_set:
    - requested_slot: bkinfo_duration
  - intent: revise_checkin_time
    entities:
      - time: '2022-09-05T00:00:00.000-07:00'
  - slot_was_set:
      - bkinfo_checkin_time: '2022-09-05T00:00:00.000-07:00'
  - action: action_execution_rejected
  - action: action_deactivate_loop
  - active_loop: null
  - action: botacts_utter_revised_bkinfo
  - action: bkinfo_form
  - active_loop: bkinfo_form
  - slot_was_set:
      - requested_slot: bkinfo_duration

- story: when information is being collected, user wants to revise duration
  steps:
  - slot_was_set:
    - botmind_state: attentive
    - botmind_context: workingonbooking
    - botmemo_booking_progress: information_collecting
    - bkinfo_area: true
    - bkinfo_checkin_time: true
    - bkinfo_duration: true
    - bkinfo_bed_type: null
    - bkinfo_price: null
    - bkinfo_room_id: null
    - search_result_flag: waiting
  - action: bkinfo_form
  - active_loop: bkinfo_form
  - slot_was_set:
    - requested_slot: bkinfo_bed_type
  - intent: revise_room_reservation_duration
    entities:
      - duration: 3
  - slot_was_set:
      - bkinfo_duration: 3
  - action: action_execution_rejected
  - action: action_deactivate_loop
  - active_loop: null
  - action: botacts_utter_revised_bkinfo
  - action: bkinfo_form
  - active_loop: bkinfo_form
  - slot_was_set:
      - requested_slot: bkinfo_bed_type

- story: when information is being collected, user wants to revise bed type
  steps:
  - slot_was_set:
    - botmind_state: attentive
    - botmind_context: workingonbooking
    - botmemo_booking_progress: information_collecting
    - bkinfo_area: true
    - bkinfo_checkin_time: true
    - bkinfo_duration: true
    - bkinfo_bed_type: true
    - bkinfo_price: null
    - bkinfo_room_id: null
    - search_result_flag: waiting
  - action: bkinfo_form
  - active_loop: bkinfo_form
  - slot_was_set:
    - requested_slot: bkinfo_price
  - intent: revise_bed_type
    entities:
      - bed_type: single
  - slot_was_set:
    - bkinfo_bed_type: single
  - action: action_execution_rejected
  - action: action_deactivate_loop
  - active_loop: null
  - action: botacts_utter_revised_bkinfo
  - action: bkinfo_form
  - active_loop: bkinfo_form
  - slot_was_set:
      - requested_slot: bkinfo_price

- story: when information has been collected completely, bkinfo_area
  steps:
  - checkpoint: checkpoint_done_information_collecting
  - action: bot_search_hotel_rooms
  - slot_was_set:
    - search_result_flag: notfound
  - action: botacts_show_room_list
  - slot_was_set:
    - botmemo_booking_progress: room_showing
  - intent: revise_area
    entities:
      - area: hawaii
  - slot_was_set:
      - bkinfo_area: hawaii
  - action: botacts_utter_revised_bkinfo
  - action: bot_relieves_imposition_to_think

- story: when information has been collected completely, bkinfo_checkin_time
  steps:
  - checkpoint: checkpoint_done_information_collecting
  - action: bot_search_hotel_rooms
  - slot_was_set:
    - search_result_flag: available
  - action: botacts_show_room_list
  - slot_was_set:
    - botmemo_booking_progress: room_showing
  - intent: revise_checkin_time
    entities:
      - time: '2022-09-05T00:00:00.000-07:00'
  - slot_was_set:
      - bkinfo_checkin_time: '2022-09-05T00:00:00.000-07:00'
  - action: botacts_utter_revised_bkinfo
  - action: bot_relieves_imposition_to_think

- story: when information has been collected completely, bkinfo_duration
  steps:
  - checkpoint: checkpoint_done_information_collecting
  - action: bot_search_hotel_rooms
  - slot_was_set:
    - search_result_flag: notfound
  - action: botacts_show_room_list
  - slot_was_set:
    - botmemo_booking_progress: room_showing
  - intent: revise_room_reservation_duration
    entities:
      - duration: 3
  - slot_was_set:
      - bkinfo_duration: 3
  - action: botacts_utter_revised_bkinfo
  - action: bot_relieves_imposition_to_think

- story: when information has been collected completely, bkinfo_bed_type
  steps:
  - checkpoint: checkpoint_done_information_collecting
  - action: bot_search_hotel_rooms
  - slot_was_set:
    - search_result_flag: available
  - action: botacts_show_room_list
  - slot_was_set:
    - botmemo_booking_progress: room_showing
  - intent: revise_bed_type
    entities:
      - bed_type: single
  - slot_was_set:
    - bkinfo_bed_type: single
  - action: botacts_utter_revised_bkinfo
  - action: bot_relieves_imposition_to_think

- story: when information has been collected completely, bkinfo_price
  steps:
  - checkpoint: checkpoint_done_information_collecting
  - action: bot_search_hotel_rooms
  - slot_was_set:
    - search_result_flag: notfound
  - action: botacts_show_room_list
  - slot_was_set:
    - botmemo_booking_progress: room_showing
  - intent: revise_price
    entities:
      - amount-of-money: 200 USD
  - slot_was_set:
    - bkinfo_price: 200
  - action: botacts_utter_revised_bkinfo
  - action: bot_relieves_imposition_to_think
